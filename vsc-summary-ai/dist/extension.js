"use strict";var f=Object.create;var c=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var C=(e,o)=>{for(var t in o)c(e,t,{get:o[t],enumerable:!0})},d=(e,o,t,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of g(o))!v.call(e,s)&&s!==t&&c(e,s,{get:()=>o[s],enumerable:!(n=y(o,s))||n.enumerable});return e};var l=(e,o,t)=>(t=e!=null?f(S(e)):{},d(o||!e||!e.__esModule?c(t,"default",{value:e,enumerable:!0}):t,e)),x=e=>d(c({},"__esModule",{value:!0}),e);var I={};C(I,{activate:()=>P,deactivate:()=>R});module.exports=x(I);var w=l(require("vscode"));var r=l(require("vscode")),u=l(require("child_process")),i=l(require("path")),p=require("fs"),m=null;function M(){if(m)return;let e=i.join(__dirname,"..","..","assistant.py");m=u.spawn("python",[e],{cwd:i.dirname(e),detached:!0,stdio:"ignore"}),m.unref(),console.log("\u{1F680} Flask backend started.")}async function h(){let e=r.window.createOutputChannel("VSC Summary AI");if(await r.window.showInformationMessage("Welcome to VSC Summary AI",{modal:!0},"Select Repository","Exit")==="Select Repository"){let t="",n=!1;for(;!n;){let s=await r.window.showOpenDialog({canSelectMany:!1,canSelectFiles:!1,canSelectFolders:!0,openLabel:"Select Folder"});if(s&&s[0]){t=s[0].fsPath;let a=i.join(t,".git");if(p.existsSync(a)&&p.lstatSync(a).isDirectory())n=!0,console.log("Repository set: ",t);else if(await r.window.showWarningMessage("The selected folder is not a Git repository.","Try Again","Cancel")==="Cancel")return}}t===""&&r.window.showWarningMessage("No repository is selected."),M(),fetch("http://127.0.0.1:5000/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({repo_path:t})}).then(s=>s.json()).then(s=>{let a=s;a.summary?(r.window.showInformationMessage("Summary generated!"),e.appendLine(a.summary),e.show()):r.window.showErrorMessage(a.error||"Something went wrong.")}).catch(s=>{r.window.showErrorMessage(`Request failed: ${s.message}`)})}else{console.log("You have exited VSC Summary AI.");return}}function P(e){console.log("VSC Summary AI is now active!");let o=w.commands.registerCommand("vsc-summary-ai.summarise",h);e.subscriptions.push(o)}function R(){}0&&(module.exports={activate,deactivate});
