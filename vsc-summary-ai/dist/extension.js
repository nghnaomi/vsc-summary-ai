"use strict";var g=Object.create;var l=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var C=(e,s)=>{for(var o in s)l(e,o,{get:s[o],enumerable:!0})},p=(e,s,o,i)=>{if(s&&typeof s=="object"||typeof s=="function")for(let a of S(s))!k.call(e,a)&&a!==o&&l(e,a,{get:()=>s[a],enumerable:!(i=y(s,a))||i.enumerable});return e};var d=(e,s,o)=>(o=e!=null?g(v(e)):{},p(s||!e||!e.__esModule?l(o,"default",{value:e,enumerable:!0}):o,e)),R=e=>p(l({},"__esModule",{value:!0}),e);var x={};C(x,{activate:()=>P,deactivate:()=>I});module.exports=R(x);var f=d(require("vscode"));var t=d(require("vscode")),h=d(require("child_process")),c=d(require("path")),u=require("fs"),m=null;function b(){if(m)return;let e=c.join(__dirname,"..","..","assistant.py");m=h.spawn("python",[e],{cwd:c.dirname(e),detached:!0,stdio:"ignore"}),m.unref(),console.log("\u{1F680} Flask backend started.")}function M(){return fetch("http://localhost:5000",{method:"GET"}).then(e=>e.ok).catch(()=>!1)}async function w(){let e=t.window.createOutputChannel("VSC Summary AI");if(await t.window.showInformationMessage("Welcome to VSC Summary AI",{modal:!0},"Select Repository")==="Select Repository"){let o="",i=!1;for(;!i;){let n=await t.window.showOpenDialog({canSelectMany:!1,canSelectFiles:!1,canSelectFolders:!0,openLabel:"Select Folder"});if(n&&n[0]){o=n[0].fsPath;let r=c.join(o,".git");if(u.existsSync(r)&&u.lstatSync(r).isDirectory())i=!0,console.log("Repository set: ",o);else if(await t.window.showWarningMessage("The selected folder is not a Git repository.","Try Again","Cancel")==="Cancel")break}}if(o===""&&t.window.showWarningMessage("No repository is selected."),b(),!await M()){t.window.showErrorMessage("Flask backend is not running.");return}fetch("http://localhost:5000/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({repo_path:o})}).then(n=>n.json()).then(n=>{let r=n;r.summary?(t.window.showInformationMessage("Summary generated!"),e.appendLine(r.summary),e.show()):t.window.showErrorMessage(r.error||"Something went wrong.")}).catch(n=>{t.window.showErrorMessage(`Request failed: ${n.message}`)})}}function P(e){console.log("VSC Summary AI is now active!");let s=f.commands.registerCommand("vsc-summary-ai.summarise",w);e.subscriptions.push(s)}function I(){}0&&(module.exports={activate,deactivate});
